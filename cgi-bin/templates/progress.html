<!DOCTYPE html>
<html>
<head>
    <title>MyPyTutor Progress :: ${user.name}</title>
</head>
<link href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css" rel="stylesheet"/>
<style>
    th.problem,
    td.problem {
        width: 25%;
    }

    th.status,
    td.status {
        width: 20%;
    }

    th.submit_time,
    td.submit_time {
        width: 20%;
    }

    % if is_admin:
    th.allow_late,
    td.allow_late {
        width: 25%;
    }

    % endif
    .panel-heading i.down,
    .panel-heading.collapsed i.up {
        display: none;
    }

    .panel-heading i.up,
    .panel-heading.collapsed i.down {
        display: inline-block;
    }

    .panel-heading {
        cursor: pointer;
    }

    header h1 a,
    header h1 a:hover,
    header h1 a:focus {
        color: inherit;
        text-decoration: inherit;
    }
</style>
<body>

<div class="container">
    <header>
        <div class="page-header">
            <h1><a href="">MyPyTutor Progress for ${user.name}</a>
                <small>(${user.id})</small>
            </h1>
            <p class="lead">Total mark: ${mark} / ${total} = ${round(100.*mark/total, 2)}% (${late} late)</p>
            % if is_admin:
            <ol class="breadcrumb">
              <li><a href="admin.py">Admin Dashboard</a></li>
              <li class="active">${user.name}</li>
            </ol>
            % endif
        </div>
    </header>

    % if message:
    <div class="alert alert-dismissible ${message[0]}">
    <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
    ${message[1]}
    </div>

    % endif
    <div class="panel-group" id="problemSets" role="tablist" aria-multiselectable="true">
        % for group in groups:
        <div class="panel panel-default">
            <div class="panel-heading" role="tab" id="heading${loop.index}" data-toggle="collapse"
                 data-parent="#problemSets" href="#collapse${loop.index}" aria-expanded="true"
                 aria-controls="collapseOne">
                <div class="panel-title clearfix">
                    <h4 class="pull-left">
                        ${group.get('title')}
                        <small>(${len(group['problems'])})</small>
                        <!--<small>(Week ${group.get('week')})</small>-->
                    </h4>
                    <h4 class="pull-right">Due ${group.get('due')}
                    <i class="glyphicon glyphicon-circle-arrow-down down"></i>
                    <i class="glyphicon glyphicon-circle-arrow-up up"></i>
                    </h4>
                </div>
            </div>
            <div id="collapse${loop.index}" class="panel-collapse collapse ${'in' if loop.index == openIndex else ''}"
                 role="tabpanel" aria-labelledby="heading${loop.index}">
                <div class="panel-body">
                    <table class="table">
                        <thead>
                        <tr>
                            <th class="problem">Problem</th>
                            <th class="status">Status</th>
                            <th class="submit_time">Submit Time</th>
                            % if is_admin:
                            <th class="allow_late">Admin Actions</th>
                            % endif
                        </tr>
                        </thead>
                        <tbody>
                        % for problem in group['problems']:
                        <tr class="${'success' if problem.get('status') in ('submitted', 'late_ok') else ('danger' if problem.get('status') == 'late' else 'warning')}">
                            <td class="problem">${problem['title']}</td>
                            <td class="status">
                                %if problem.get('status') == 'submitted':
                                <i class="glyphicon glyphicon-ok"></i> <em>Submitted</em>
                                % elif problem.get('status') == 'late_ok':
                                <i class="glyphicon glyphicon-ok"></i> <em>Submitted late without penalty</em>
                                % elif problem.get('status') == 'late':
                                <i class="glyphicon glyphicon-remove"></i> <em>Late</em>
                                % else:
                                <i class="glyphicon glyphicon-minus"></i> <em>Unsubmitted</em>
                                % endif
                            </td>
                            <td class="submit_time">
                                % if problem.get('status') != 'unsubmitted':
                                    ${problem.get('submit_time')}
                                % endif
                            </td>
                            % if is_admin:
                            <td class="allow_late">
                                <form action="" method="POST">
                                <input name="hash" type="hidden" value="${problem['hash']}"></input>
                                % if problem['has_allow_late']:
                                    <input name="allow_late" type="hidden" value="off"></input>
                                    % if problem['status'] == 'unsubmitted':
                                    <span class="btn-xs">Late submission is allowed.</span>
                                    <button class="btn btn-link btn-xs" type="submit">Disallow</button>
                                    % elif problem['status'] == 'late_ok':
                                    <button class="btn btn-link btn-xs" type="submit">Disallow Late Submission</button>
                                    % endif
                                % elif problem['status'] != 'submitted':
                                    <input name="allow_late" type="hidden" value="on"></input>
                                    <button class="btn btn-link btn-xs" type="submit">Allow Late Submission</button>
                                % endif
                                </form>
                            </td>
                            % endif
                        </tr>
                        % endfor
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        % endfor


        <!--<div class="panel panel-default">-->
        <!--<div class="panel-heading" role="tab" id="headingTwo">-->
        <!--<h4 class="panel-title">-->
        <!--<a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo"-->
        <!--aria-expanded="false" aria-controls="collapseTwo">-->
        <!--Collapsible Group Item #2-->
        <!--</a>-->
        <!--</h4>-->
        <!--</div>-->
        <!--<div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">-->
        <!--<div class="panel-body">-->
        <!--Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. 3-->
        <!--wolf moon officia aute, non cupidatat skateboard dolor brunch. Food truck quinoa nesciunt laborum-->
        <!--eiusmod. Brunch 3 wolf moon tempor, sunt aliqua put a bird on it squid single-origin coffee nulla-->
        <!--assumenda shoreditch et. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt-->
        <!--sapiente ea proident. Ad vegan excepteur butcher vice lomo. Leggings occaecat craft beer-->
        <!--farm-to-table, raw denim aesthetic synth nesciunt you probably haven't heard of them accusamus-->
        <!--labore sustainable VHS.-->
        <!--</div>-->
        <!--</div>-->
        <!--</div>-->
    </div>
</div>

<script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
</body>
</html>
